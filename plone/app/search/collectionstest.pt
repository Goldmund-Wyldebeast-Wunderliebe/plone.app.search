<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      lang="en"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="plone">
<head>
    <metal:block metal:fill-slot="head_slot">
    <!-- XXX FIX XXX -->
    
        <link rel="alternate" title="RSS 1.0" type="application/rss+xml"
              tal:define="here_url context/@@plone_context_state/object_url"
              tal:condition="request/SearchableText|nothing"
              tal:attributes="href string:$here_url/search_rss?${request/QUERY_STRING}"/>
    </metal:block>

    <metal:block fill-slot="top_slot"
                 tal:define="dummy python:request.set('disable_border',1)" />
    <metal:block fill-slot="column_one_slot" />
    <metal:block fill-slot="column_two_slot" />
</head>

<body>
<div metal:fill-slot="main" tal:define="indexes python:view.getConfig()['indexes']">


      <form action="" method="get" accept-charset="utf-8" id="advancedsearch">
        <fieldset>            
            <div tal:repeat="row context/REQUEST/form/query" tal:condition="exists: context/REQUEST/form/query">
                    <div class="field">
                        <div class="formHelp"><!-- --></div>
                        <select name="query.i:records">
                            <tal:index repeat="index python:indexes.keys()">
                            <option tal:attributes="value index; selected python:row['i'] == index and 'selected' or nothing" 
                                    tal:content="python:indexes[index]['friendly_name']">Index</option>
                            </tal:index>
                        </select>
                    
                        <select name="query.c:records" tal:define="index_name python:row['i'];
                                                                   operators python:indexes[index_name]['operators']">
                            <tal:operators repeat="operator python:operators.keys()">
                                <option tal:attributes="value operator; 
                                                        selected python:row['c'] == operator and 'selected' or nothing" 
                                        tal:content="python:operators[operator]['friendly_name']">Operator</option>                            
                            </tal:operators>
                        </select>
                        <input type="text" name="query.v:records" value="Text for Search"
                               tal:attributes="value python:row['v']"/>

                        <a href="" class="discreet" title="Remove parameter">Remove parameter</a>
                    </div>
                </div>
                
                <div class="field">
                    <div class="formHelp"><!-- --></div>
                    <select name="query.i:records">
                        <option value="empty" selected="selected">Choose your parameter...</option>
                        <tal:index repeat="index python:indexes.keys()">                        
                        <option tal:attributes="value index;"
                                tal:content="python:indexes[index]['friendly_name']">Index</option>
                        </tal:index>
                    </select>
                </div>


            <div class="sortingField">
                <div class="formHelp"><!-- --></div>
                <label for="sort_on">
                    Sort on
                </label>
                <select name="sort_on" id="sort_on">
                    <option value="Searchable Text">Searchable Text</option>
                    <option value="Content type">Content type</option>
                    <option value="Keywords" selected="selected">Keywords</option>     
                </select>

                <input type="checkbox" name="sort_order" value="Reversed order" checked="checked" id="sort_order"/>
                <label for="sort_order">Reversed order</label>            
            </div>
            
        </fieldset>
      </form>

<script tal:content="python:view.getJavascriptConfig()"></script>
      
</div>
</body>
</html>




